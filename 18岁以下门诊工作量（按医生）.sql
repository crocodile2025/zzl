SELECT EMP_ID ,NAME,SUM(SL2019), SUM(JE2019),sum(sl2018) ,sum(je2018) 
FROM 
(
SELECT  T1.EMP_ID ,T5.NAME, COUNT( DISTINCT T1.CLINIC_ID) AS SL2019 ,SUM(JE) AS JE2019, 0 as sl2018,0 as je2018
                  FROM  KTHIS5.OIS_WORK_LOG T1,KTHIS5.PAT_REGISTER T2,KTHIS5.OIS_TS T3,KTHIS5.OIS_REG_INFO T4 ,KTHIS5.pub_emp T5 , MZSFMXXX A,MZSFXX B
                WHERE T1.OPC_ID = T2.REG_ID 
                  AND T1.CLINIC_ID = T3.CLINIC_ID(+)
                  AND T2.REG_ID = T4.OPC_ID
                  AND T2.SOURCE_TYPE = 1
                  AND T1.EMP_ID=T5.ID(+) 
                  AND T1.BRANCH_CODE = '00'
                    AND T4.OPC_NO=B.MZH AND A.NO=B.NO
 AND T1.CLINIC_ID >= 2019010100001
 AND T1.CLINIC_ID <= 2019063199999
AND floor(MONTHS_BETWEEN(sysdate,TRUNC(T2.DATE_OF_BIRTH))/12)<=18
GROUP BY  T1.EMP_ID ,T5.NAME
UNION ALL 

SELECT  T1.EMP_ID ,T5.NAME,COUNT( DISTINCT T1.CLINIC_ID) AS SL2019,
                SUM(A.JE)  AS JE2019, 0 as sl2018,0 as je2018
                  FROM  KTHIS5.OIS_WORK_LOG T1,KTHIS5.PAT_REGISTER T2,KTHIS5.OIS_TS T3,KTHIS5.OIS_REG_INFO T4 ,KTHIS5.pub_emp T5,  HMISW2003_GT.MZSFMXXX A,HMISW2003_GT.MZSFXX B 
                WHERE T1.OPC_ID = T2.REG_ID 
                  AND T1.CLINIC_ID = T3.CLINIC_ID(+)
                  AND T2.REG_ID = T4.OPC_ID
                  AND T2.SOURCE_TYPE = 1
                  AND T1.EMP_ID=T5.ID(+) 
                  AND T1.BRANCH_CODE = '02'
                  AND T4.OPC_NO=B.MZH AND A.NO=B.NO
 AND T1.CLINIC_ID >= 2019010100001
 AND T1.CLINIC_ID <= 2019063199999
AND floor(MONTHS_BETWEEN(sysdate,TRUNC(T2.DATE_OF_BIRTH))/12)<=18
GROUP BY  T1.EMP_ID ,T5.NAME

union all
SELECT  T1.EMP_ID ,T5.NAME, 0 as sl2019,0 as je2019 ,COUNT( DISTINCT T1.CLINIC_ID) AS SL2018 ,SUM(JE) AS JE2018
                  FROM  KTHIS5.OIS_WORK_LOG T1,KTHIS5.PAT_REGISTER T2,KTHIS5.OIS_TS T3,KTHIS5.OIS_REG_INFO T4 ,KTHIS5.pub_emp T5 , MZSFMXXX A,MZSFXX B
                WHERE T1.OPC_ID = T2.REG_ID 
                  AND T1.CLINIC_ID = T3.CLINIC_ID(+)
                  AND T2.REG_ID = T4.OPC_ID
                  AND T2.SOURCE_TYPE = 1
                  AND T1.EMP_ID=T5.ID(+) 
                  AND T1.BRANCH_CODE = '00'
                    AND T4.OPC_NO=B.MZH AND A.NO=B.NO
 AND T1.CLINIC_ID >= 2018010100001
 AND T1.CLINIC_ID <= 2018063199999
AND floor(MONTHS_BETWEEN(sysdate,TRUNC(T2.DATE_OF_BIRTH))/12)<=18
GROUP BY  T1.EMP_ID ,T5.NAME
UNION ALL 

SELECT  T1.EMP_ID ,T5.NAME,0 as sl2019,0 as je2019 ,COUNT( DISTINCT T1.CLINIC_ID) AS SL2018,
                SUM(A.JE)  AS JE2018
                  FROM  KTHIS5.OIS_WORK_LOG T1,KTHIS5.PAT_REGISTER T2,KTHIS5.OIS_TS T3,KTHIS5.OIS_REG_INFO T4 ,KTHIS5.pub_emp T5,  HMISW2003_GT.MZSFMXXX A,HMISW2003_GT.MZSFXX B 
                WHERE T1.OPC_ID = T2.REG_ID 
                  AND T1.CLINIC_ID = T3.CLINIC_ID(+)
                  AND T2.REG_ID = T4.OPC_ID
                  AND T2.SOURCE_TYPE = 1
                  AND T1.EMP_ID=T5.ID(+) 
                  AND T1.BRANCH_CODE = '02'
                  AND T4.OPC_NO=B.MZH AND A.NO=B.NO
 AND T1.CLINIC_ID >= 2018010100001
 AND T1.CLINIC_ID <= 2018063199999
AND floor(MONTHS_BETWEEN(sysdate,TRUNC(T2.DATE_OF_BIRTH))/12)<=18
GROUP BY  T1.EMP_ID ,T5.NAME

) A 
GROUP BY  EMP_ID ,NAME
ORDER BY NAME
